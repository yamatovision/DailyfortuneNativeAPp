# DailyFortuneネイティブアプリ移行チェックリスト

## 初期設定・環境構築
- [x] 1. 新規プロジェクト作成 (`DailyFortune-Native`)
- [x] 2. 不要ファイル削除 (.git, node_modules など)
- [x] 3. Git リポジトリ初期化
- [x] 4. package.json の名前を `dailyfortune-native` に更新
- [x] 5. README と関連ドキュメントの更新

## Capacitor導入
- [~] 6. Capacitor Core と CLI をインストール
- [ ] 7. Capacitor プロジェクト初期化 (`npx cap init`)
- [ ] 8. vite.config.ts の base を `'./'` に変更
- [ ] 9. Capacitor Preferences パッケージをインストール
- [ ] 10. npm run build の実行
- [ ] 11. Android プラットフォーム追加 (`npx cap add android`)
- [ ] 12. iOS プラットフォーム追加 (`npx cap add ios`)
- [ ] 13. capacitor.config.ts の設定

## API設定と環境変数
- [ ] 14. 本番環境用API URL設定
- [ ] 15. API通信のHTTPS強制対応
- [ ] 16. バックエンドのCORS設定確認・調整

## ストレージシステム実装
- [ ] 17. IStorageService インターフェース作成
- [ ] 18. CapacitorStorageService 実装 (Preferences 使用)
- [ ] 19. WebStorageService 実装 (localStorage バックアップ)
- [ ] 20. プラットフォーム検出ロジック実装

## 認証システム対応
- [ ] 21. token.service.ts の非同期対応
- [ ] 22. AuthContext の非同期対応
- [ ] 23. ローディング状態の適切な管理実装
- [ ] 24. 認証関連の全コンポーネント更新
- [ ] 25. JWT更新ロジックの非同期対応
- [ ] 26. ログイン・ログアウトフローのテスト
- [ ] 27. セッション管理の最適化

## ネットワーク監視実装
- [ ] 28. NetworkMonitorService の作成
- [ ] 29. プラットフォーム別ネットワーク検出実装
- [ ] 30. ネットワーク状態表示コンポーネント作成
- [ ] 31. オフライン状態時の UI フィードバック実装

## APIサービスのオフライン対応 (基本)
- [ ] 32. GET リクエストのキャッシュシステム実装
- [ ] 33. キャッシュのタイムスタンプと有効期限管理
- [ ] 34. キャッシュのクリア機能実装
- [ ] 35. オフライン読み取り時のキャッシュフォールバック実装
- [ ] 36. オンライン復帰時のキャッシュ再検証ロジック

## UI/UXのモバイル最適化
- [ ] 37. ボタンサイズとタッチターゲット拡大
- [ ] 38. フォントサイズと余白の調整
- [ ] 39. スクロール動作の最適化
- [ ] 40. フォーム入力のモバイル最適化
- [ ] 41. キーボード表示時の UI 調整
- [ ] 42. スプラッシュスクリーン設定
- [ ] 43. アプリアイコン設定
- [ ] 44. ナビゲーションの最適化（スワイプ操作等）
- [ ] 45. モバイル向けローディングインジケーター調整

## プラットフォーム固有設定
- [ ] 46. Android マニフェスト設定（権限など）
- [ ] 47. iOS Info.plist 設定（権限など）
- [ ] 48. Android アイコンセット準備（各解像度）
- [ ] 49. iOS アイコンセット準備（各解像度）
- [ ] 50. Android スプラッシュ画像準備
- [ ] 51. iOS スプラッシュ画像準備
- [ ] 52. Android キーボード設定
- [ ] 53. iOS キーボード設定

## アプリ基本機能実装
- [ ] 54. バックボタン処理の実装
- [ ] 55. アプリ終了処理の実装
- [ ] 56. ディープリンク基本設定
- [ ] 57. スクリーン方向設定（縦横）
- [ ] 58. App.tsx のライフサイクル処理調整
- [ ] 59. エラーバウンダリの実装
- [ ] 60. クラッシュレポート基本設定

## ビルド設定
- [ ] 61. Android ビルド設定（build.gradle）
- [ ] 62. iOS ビルド設定（Xcode project）
- [ ] 63. Android リリース用署名Keystore作成
- [ ] 64. iOS 証明書とプロビジョニングプロファイル設定
- [ ] 65. ビルド環境変数の設定
- [ ] 66. ビルドスクリプト作成

## テスト環境
- [ ] 67. Android デバッグビルドの生成と動作確認
- [ ] 68. iOS デバッグビルドの生成と動作確認
- [ ] 69. 複数デバイスでのレイアウトテスト
- [ ] 70. オフライン⇔オンライン切り替えテスト
- [ ] 71. ローカルストレージの動作確認
- [ ] 72. 主要機能の動作確認テスト（運勢表示、プロフィール設定等）
- [ ] 73. 各画面遷移のテスト
- [ ] 74. フォーム送信とバリデーションテスト

## 配布準備
- [ ] 75. App Store Connect アカウント設定
- [ ] 76. Google Play Console アカウント設定
- [ ] 77. App Storeスクリーンショット準備（各デバイスサイズ）
- [ ] 78. Google Playスクリーンショット準備（各デバイスサイズ）
- [ ] 79. アプリ説明文の準備
- [ ] 80. プライバシーポリシーの調整
- [ ] 81. アプリのカテゴリとレーティング設定
- [ ] 82. TestFlight の設定 (iOS)
- [ ] 83. Firebase App Distribution の設定 (Android)
- [ ] 84. テスター向けガイド作成

## リリースビルド
- [ ] 85. バージョン番号と識別子の設定
- [ ] 86. デバッグコードの削除
- [ ] 87. リリース用APIエンドポイント設定
- [ ] 88. Android リリースビルド生成
- [ ] 89. iOS リリースビルド生成
- [ ] 90. リリースビルドの最終動作確認

## CI/CD
- [ ] 91. GitHub Actions ワークフロー設定
- [ ] 92. 自動ビルドの設定
- [ ] 93. 自動テストの設定
- [ ] 94. テスト配布の自動化

## 最終確認
- [ ] 95. アプリ起動・終了サイクルテスト
- [ ] 96. メモリ使用量チェック
- [ ] 97. バッテリー消費テスト
- [ ] 98. 初回起動時の動作確認
- [ ] 99. アプリ再インストール後の動作確認
- [ ] 100. すべての主要機能の最終確認
- [ ] 101. 設定・環境値の最終確認

## 配布とモニタリング
- [ ] 102. App Storeへの提出
- [ ] 103. Google Playへの提出
- [ ] 104. レビュープロセスの監視
- [ ] 105. 初期ユーザーフィードバックの収集準備

# 更新ルール

1. タスク完了時：
   - タスク番号の横にある `[ ]` を `[x]` に変更
   - 完了したタスクに関するエラーログがあれば削除
   - 進捗管理セクションの完了タスク数と進捗率を更新
   - 最終更新日を更新

2. エラー発生時：
   - エラー引き継ぎログに構造化された情報を追加
   - 参考資料があればリンクを追加

3. タスク開始時：
   - 着手中のタスクを明示するため `[ ]` を `[~]` に変更（任意）

## 進捗管理
- 完了タスク数: 5/105
- 進捗率: 4.76%
- 最終更新日: 2025/4/17

## 参考資料リンク

- [ネイティブアプリ実装ガイド](/docs/native-app-implementation-guide.md) - Capacitorを使った実装の詳細ガイド
- [ネイティブアプリ移行計画](/docs/native-app-migration-plan.md) - 移行全体の計画書
- [Capacitor公式ドキュメント](https://capacitorjs.com/docs) - Capacitorの公式リファレンス
- [Vite+React+TypeScript構成](https://vitejs.dev/guide/) - ビルド設定の参考

## エラー引き継ぎログ

このセクションには、タスク実行中に発生した問題とその解決策を記録します。タスクが完了したら、そのタスクに関するログは削除して構いません。

### 記録形式

```
【タスク番号】タスク名
- 問題：遭遇した問題の詳細
- 試行：試行した解決策
- 結果：成功または失敗、部分的な成功
- 解決策：最終的な解決策または回避策
- メモ：引き継ぎに必要な追加情報
- 参考：関連する参考資料へのリンク（任意）
```

### 現在のエラーログ

【例】：
```
【21】token.service.ts の非同期対応
- 問題：トークンの非同期取得がAuthContext内の同期的なチェックと競合
- 試行1：async/awaitを使ってトークン取得を非同期化
- 結果1：AuthContextの初期化時に問題が発生
- 試行2：useEffectでの初期化時に条件分岐を追加
- 結果2：成功。ただしレンダリング順序に注意が必要
- 解決策：AuthContextのロード状態を追加し、トークン読み込み完了まで子コンポーネントをレンダリングしないよう修正
- メモ：同様のパターンは他の認証関連コンポーネントでも使用する必要あり
- 参考：https://react.dev/reference/react/useEffect#fetching-data-with-effects
```